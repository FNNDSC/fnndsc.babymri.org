<link rel="import" href="../../lib-elements/polymer-jsonp/polymer-jsonp.html">

<link rel="import" href="../page/page.html">
<link rel="import" href="../people/people.html">

<polymer-element name="team-element" extends="page-element">
  <template>

    <link rel="stylesheet" href="../../styles/main.css">
    <link rel="stylesheet" type="text/css" href="../page/page.css" />

      <div class="container">
        <div id="jumbo" class=" jumbotron fBox" >
            <template if="{{team == null && cache == null}}">
              <img class="spinner" src="../../images/spinner.gif">
            </template>
            <span class="small">We are a multidisciplinary</span>
            <span class="large {{name}}">team</span>
      </div>
      <div class="row">
        <div class="col-md-2 ">
          <div id='{{name}}-affix'  class="fBox">
            <ul id='{{name}}-navigation' class="nav ">
              Navigation
              <template if="{{structure != null}}">
                <template repeat="{{section in structure}}">
                  <li on-tap="{{gotoSection}}">
                    <a id='{{name}}-nav-{{section.index}}' class='{{name}}' data-section='{{section.index}}'>{{section.label}}</a>
                  </li> 
                </template> 
              </template>
            </ul>
          </div>
        </div>
        <div class="col-md-10">
        <div class="fBox">

        <section id="faculty" class="element row">
          <div class="title {{name}}">faculty members</div>
          <div class="peeps">
            <template if="{{team != null}}">
              <template repeat="{{people in team.feed.entry}}">
                <template if="{{people.gsx$group.$t === 'faculty'}}">
                  <people-element people="{{people}}" peopleLoaded="{{peopleLoaded}}"></people-element>
                </template>
              </template>
            </template>
          </div>
        </section>
  
        <section  id="staff" class="element row">
          <div class="title {{name}}">staff</div>
          <div class="peeps">
            <template if="{{team != null}}"> 
              <template repeat="{{people in team.feed.entry}}">
                <template if="{{people.gsx$group.$t === 'staff'}}">
                  <people-element people="{{people}}" peopleLoaded="{{peopleLoaded}}"></people-element>
                </template>
              </template>
            </template>
          </div>
        </section>
  
        <section id="collaborators" class="element row">
          <div class="title {{name}}">collaborators</div>
          <div class="peeps">
            <template if="{{team != null}}">
              <template repeat="{{people in team.feed.entry}}">
                <template if="{{people.gsx$group.$t === 'collaborators'}}">
                  <people-element people="{{people}}" peopleLoaded="{{peopleLoaded}}"></people-element>
                </template>
              </template>
            </template>
          </div>
        </section>
  
        <section id="alumni" class="element row">
          <div class="title {{name}}">alumni</div>
          <div class="peeps">
            <template if="{{team != null}}">
              <template repeat="{{people in team.feed.entry}}">
                <template if="{{people.gsx$group.$t === 'alumni'}}">
                  <people-element people="{{people}}" peopleLoaded="{{peopleLoaded}}"></people-element>
                </template>
              </template>
            </template>
          </div>
        </section>


    </div>
    </div>

    </div>
    </div>

  <template if="{{cache == null && attached == 1 }}">
  <polymer-jsonp auto url="https://spreadsheets.google.com/feeds/list/{{spreadsheet}}/od6/public/values?alt=json-in-script&callback=" response="{{team}}"></polymer-jsonp>
</template>

  </template>
  <script>
    Polymer('team-element', {
      name: 'team',
      spreadsheet: '0Asu7h0aKnydhdHN6R2lCX1N4VlZ3dnB2ZHhLWWFZQ3c',
      attached: function(){
        this.super();
        if(this.cache != null){
          this.team = this.cache;
        }
        this.attached = 1;
      },
      peopleLoadedChanged: function(){
        this.refresh();
      },
      teamChanged: function(){
        if(this.team){
          this.cache = this.team; 
        }
      }
      // attached: function(){
      //   this.super();
      //   var self = this;
      //   this.onload=function(){self.refresh();};
      //   // catch people loaded here!
      //   // to refresh!
      // }
    });

  </script>
</polymer-element>
