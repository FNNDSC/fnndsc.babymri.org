<link rel="import" href="../../lib-elements/polymer-jsonp/polymer-jsonp.html">

<link rel="import" href="../page/page.html">

<polymer-element name="contact-element" extends="page-element">
  <template>

<!-- <link rel="stylesheet" href="contact.css"> -->

      <div class="container">
        <div id="jumbo" class=" jumbotron fBox" >
          <template if="{{contact == null && cache == null}}">
            <img class="spinner" src="../../images/spinner.gif">
          </template>
            <span class="small">We have offices in 3 different</span>
            <span class="large {{name}}">locations</span>
      </div>
      <div class="row">
        <div class="col-md-2 ">
          <div id='{{name}}-affix'  class="fBox">
            <ul id='{{name}}-navigation' class="nav ">
              Navigation
              <template if="{{structure != null}}">
                <template repeat="{{section in structure}}">
                  <li on-tap="{{gotoSection}}">
                    <a id='{{name}}-nav-{{section.index}}' class='{{name}}' data-section='{{section.index}}'>{{section.label}}</a>
                  </li> 
                </template> 
              </template>
            </ul>
          </div>
        </div>
        <div class="col-md-10">
        <div class="fBox">

        <section id="main1" class="element">
          <div class="title {{name}}">main hospital</div>
          <template if="{{contact != null}}">
            <template repeat="{{location in contact.feed.entry}}">
              <template if="{{location.gsx$location.$t === 'main'}}">
                <div class="info">
                  {{location.gsx$name.$t}}</br>
                  {{location.gsx$address.$t}}</br>
                  {{location.gsx$city.$t}}, {{location.gsx$state.$t}} {{location.gsx$zip.$t}}</br></br>
                  <div class="icon phone">
                    <span style="padding-left:5px;">{{location.gsx$phone.$t}}</span>
                  </div>
                  <div class="icon fax">
                    <span style="padding-left:5px;">{{location.gsx$fax.$t}}</span>
                  </div>
                 </div>
              </template>
            </template>
          </template>
          <div class="notes">
            <div class='subtitle {{name}}'>Notes</div>
            <div id='main-notes'></div>
          </div>
          <div class="details">
            <div class='subtitle {{name}}'>Detailed directions</div>
            <div id='main-details'></div>
          </div>
          <div class="map">
            <div class='subtitle {{name}}'>Map</div>
            <div id="main-map"></div>
          </div>
        </section>

        <section id="autumn" class="element">
          <div class="title {{name}}">1 autumn street</div>
          <template if="{{contact != null}}">
            <template repeat="{{location in contact.feed.entry}}">
              <template if="{{location.gsx$location.$t === 'autumn'}}">
                <div  class="info">
                  {{location.gsx$name.$t}}</br>
                  {{location.gsx$address.$t}}</br>
                  {{location.gsx$city.$t}}, {{location.gsx$state.$t}} {{location.gsx$zip.$t}}</br></br>
                  <div class="icon phone">
                    <span style="padding-left:5px;">{{location.gsx$phone.$t}}</span>
                  </div>
                  <div class="icon fax">
                    <span style="padding-left:5px;">{{location.gsx$fax.$t}}</span>
                  </div>
                </div>
              </template>
            </template>
          </template>
          <div class="notes">
            <div class='subtitle {{name}}'>Notes</div>
            <div id='autumn-notes'></div>
          </div>
          <div class="details">
            <div class='subtitle {{name}}'>Detailed directions</div>
            <div id='autumn-details'></div>
          </div>
          <div class="map">
            <div class='subtitle {{name}}'>Map</div>
            <div id="autumn-map"></div>
          </div>
          
        </section>

        <section id="waltham" class="element">
          <div class="title {{name}}">waltham</div>
          <template if="{{contact != null}}">
            <template repeat="{{location in contact.feed.entry}}">
              <template if="{{location.gsx$location.$t === 'waltham'}}">
                <div  class="info">
                  {{location.gsx$name.$t}}</br>
                  {{location.gsx$address.$t}}</br>
                  {{location.gsx$city.$t}}, {{location.gsx$state.$t}} {{location.gsx$zip.$t}}</br></br>
                  <div class="icon phone">
                    <span style="padding-left:5px;">{{location.gsx$phone.$t}}</span>
                  </div>
                  <div class="icon fax">
                    <span style="padding-left:5px;">{{location.gsx$fax.$t}}</span>
                  </div>
                </div>
              </template>
            </template>
          </template>
          <div class="notes">
            <div class='subtitle {{name}}'>Notes</div>
            <div id='waltham-notes'></div>
          </div>
          <div class="details">
            <div class='subtitle {{name}}'>Detailed directions</div>
            <div id='waltham-details'></div>
          </div>
          <div class="map">
            <div class='subtitle {{name}}'>Map</div>
            <div id="waltham-map"></div>
          </div>
        </section>

    </div>
    </div>

    </div>
    </div>
  <template if="{{cache == null && attached == 1 }}">
  <polymer-jsonp auto url="https://spreadsheets.google.com/feeds/list/{{spreadsheet}}/od6/public/values?alt=json-in-script&callback=" response="{{contact}}"></polymer-jsonp>
</template>

  </template>
  <script>
    Polymer('contact-element', {
      name: 'contact',
      spreadsheet: '0Asu7h0aKnydhdHJSMXVWNzRrdWJuVFpzN05wX2N2Unc',
      attached: function(){
        this.super();
        var self = this;
        this.onload=function(){self.refresh();};

        if(this.cache != null){
          this.contact = this.cache;
        }
        this.attached = 1;
      },
      contactChanged: function(){
        if(this.contact){
            var len = this.contact.feed.entry.length;
            while (len--) {
              this.$[this.contact.feed.entry[len].gsx$location.$t+'-notes'].innerHTML = this.contact.feed.entry[len].gsx$notes.$t;
              this.$[this.contact.feed.entry[len].gsx$location.$t+'-map'].innerHTML = this.contact.feed.entry[len].gsx$map.$t;
            }

            this.cache = this.contact;
        }
      }
    });

  </script>
</polymer-element>
